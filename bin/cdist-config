#!/bin/sh
#
# 2010 Nico Schottelius (nico-cdist at schottelius.org)
#
# This file is part of cdist.
#
# cdist is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# cdist is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with cdist. If not, see <http://www.gnu.org/licenses/>.
#
#
# Print configuration directories - helper for all other scripts
#

: ${CDIST_CONFIG:=/etc/cdist}
: ${CDIST_COREDIR:=$CDIST_CONFIG/core}
: ${CDIST_LIBDIR:=$CDIST_CONFIG/lib}
: ${CDIST_HOSTS:=$CDIST_CONFIG/hosts}
: ${CDIST_MODULES:=$CDIST_CONFIG/modules}

# create basedir + tempfile for direct usage
: ${CDIST_TMPBASEDIR:=/tmp}
: ${CDIST_TMPDIR:=$(mktemp -d "$CDIST_TMPBASEDIR/cdist.XXXXXXXXXXXX")}
: ${CDIST_TMP:=$(mktemp "$CDIST_TMPDIR/cdist.XXXXXXXXXXXX")}

################################################################################
# cconf standard vars prefixed with cdist
__cdist_pwd="$(pwd -P)"
__cdist_mydir="${0%/*}";
__cdist_abs_mydir="$(cd "$__cdist_mydir" && pwd -P)"
__cdist_myname=${0##*/};
__cdist_abs_myname="$__cdist_abs_mydir/$__cdist_myname"


__cdist_debug_echo()
{
   if [ "$CDIST_DEBUG" ]; then
      echo "Debug: $@"
   fi
}

__cdist_usage()
{
   echo "$__cdist_myname: $@"
   exit 1
}


#set -e

# load libraries so every program has them available - FIXME
## find "${CDIST_LIBDIR}" -type f > "${CDIST_TMP}"
## while read __cdist_lib; do
##    __cdist_debug_echo "Loading $__cdist_lib ..."
##    . "${__cdist_lib}"
## done < "${CDIST_TMP}"
## 

# load modules, all parts => really
#find "${CDIST_MODULES}" -name manifest > "${CDIST_TMP}"

#set +e

#echo $CDIST_CONFIG
# FIXME: here or somewhere else? other parts may reuse tmp
: > "$CDIST_TMP"
#rm -f "$CDIST_TMP"
#__cdist_cur="$(pwd -P)"
