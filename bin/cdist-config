#!/bin/sh
#
# 2010 Nico Schottelius (nico-cdist at schottelius.org)
#
# This file is part of cdist.
#
# cdist is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# cdist is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with cdist. If not, see <http://www.gnu.org/licenses/>.
#
#
# Print configuration directories - helper for all other scripts
#

: ${__cdist_config:=/etc/cdist}
: ${__cdist_manifest_dir:=$__cdist_config/manifests}
: ${__cdist_manifest_init:=$__cdist_manifest_dir/init}
: ${__cdist_type_dir:=$__cdist_config/types}


# obsolete?: lib not needed, hosts replaced by manifests, modules by types
: ${__cdist_hosts:=$__cdist_config/hosts}
: ${__cdist_modules:=$__cdist_config/modules}
: ${__cdist_coredir:=$__cdist_config/core}


# create basedir + tempfile for direct usage
# FIXME: remove on exit
: ${__cdist_tmp_dir:=$(mktemp -d "/tmp/cdist.XXXXXXXXXXXX")}
: ${__cdist_tmp_file:=$(mktemp "$__cdist_tmp_dir/cdist.XXXXXXXXXXXX")}

################################################################################
# cconf standard vars prefixed with cdist
__cdist_pwd="$(pwd -P)"
__cdist_mydir="${0%/*}";
__cdist_abs_mydir="$(cd "$__cdist_mydir" && pwd -P)"
__cdist_myname=${0##*/};
__cdist_abs_myname="$__cdist_abs_mydir/$__cdist_myname"

################################################################################
# Function list
#
__cdist_debug_echo()
{
   if [ "$__cdist_debug" ]; then
      echo "Debug: $@"
   fi
}

__cdist_usage()
{
   echo "$__cdist_myname: $@"
   exit 1
}


#set -e

# load libraries so every program has them available - FIXME
## find "${__cdist_LIBDIR}" -type f > "${__cdist_TMP}"
## while read __cdist_lib; do
##    __cdist_debug_echo "Loading $__cdist_lib ..."
##    . "${__cdist_lib}"
## done < "${__cdist_TMP}"
## 

# load modules, all parts => really
#find "${__cdist_MODULES}" -name manifest > "${__cdist_TMP}"

#set +e

#echo $__cdist_CONFIG
# FIXME: here or somewhere else? other parts may reuse tmp
: > "$__cdist_TMP"
#rm -f "$__cdist_TMP"
#__cdist_cur="$(pwd -P)"
